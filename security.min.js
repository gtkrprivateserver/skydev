(function(w,d){'use strict';const C={allowedHosts:[location.hostname],allowCDN:['cdnjs.cloudflare.com'],disableRightClick:true,disablePrintScreen:true,disableDevtoolsHotkeys:true,sanitizeInputs:true,autoSanitizeForms:true,removeInlineHandlers:true,safeFetchDefaults:{allowedOrigins:[location.origin],addHeaders:{'X-Requested-With':'XMLHttpRequest'}},verbose:false};let cfg=Object.assign({},C);function l(...a){if(cfg.verbose)console.warn('[security]',...a)}function S(v){return typeof v!=='string'?v:v.replace(/<\s*script.*?>.*?<\s*\/\s*script\s*>/gi,'').replace(/javascript:/gi,'').replace(/[<>{}]/g,'').replace(/["'`;]/g,'').trim()}function SI(e){try{if(e&&'value'in e)e.value=S(e.value)}catch(x){}}function AF(){if(!cfg.autoSanitizeForms)return;d.querySelectorAll('form').forEach(f=>{f.addEventListener('submit',e=>{try{f.querySelectorAll('input[type="text"],input[type="search"],textarea,input[type="email"],input[type="tel"],input:not([type])').forEach(i=>SI(i))}catch(x){}},{passive:true});if(cfg.sanitizeInputs){f.addEventListener('input',ev=>{const t=ev.target;if(t&&(t.tagName==='INPUT'||t.tagName==='TEXTAREA'))SI(t)},true)}})}function DE(){try{w.eval=function(){l('Blocked eval');return null};w.Function=function(){l('Blocked Function');return function(){}}}catch(x){}}function T(src){if(!src)return false;try{const u=new URL(src,location.href),h=u.hostname;if(cfg.allowedHosts.includes(h))return true;return cfg.allowCDN.some(c=>h.includes(c))}catch(x){return false}}function RS(){d.querySelectorAll('script').forEach(s=>{try{if(s.src&&!T(s.src)){l('rm script',s.src);s.remove()}else if(!s.src){const t=(s.textContent||'').toLowerCase();if(t.includes('document.cookie')||t.includes('eval(')){l('rm inline');s.remove()}}}catch(x){}})}function OBS(){new MutationObserver(m=>{m.forEach(o=>{o.addedNodes&&o.addedNodes.forEach(n=>{if(n.tagName&&n.tagName.toLowerCase()==='script'){if(!T(n.src)){l('obs rm',n.src);n.remove()}}if(cfg.removeInlineHandlers&&n.attributes){[...n.attributes].forEach(a=>{if(/^on/i.test(a.name)){n.removeAttribute(a.name);l('rm on*',a.name)}})}})})}).observe(d.documentElement||d.body,{childList:true,subtree:true})}function RIH(){if(!cfg.removeInlineHandlers)return;try{const A=d.getElementsByTagName('*');for(let i=0;i<A.length;i++){const n=A[i];if(n&&n.attributes){[...n.attributes].forEach(a=>{if(/^on/i.test(a.name))n.removeAttribute(a.name)})}}}catch(x){}}function BL(){if(cfg.disableRightClick)d.addEventListener('contextmenu',e=>e.preventDefault());if(cfg.disableDevtoolsHotkeys)d.addEventListener('keydown',e=>{if(e.key==='F12'||(e.ctrlKey&&e.shiftKey&&(e.key==='I'||e.key==='J'))||(e.ctrlKey&&e.key==='U'))e.preventDefault()},true);if(cfg.disablePrintScreen)d.addEventListener('keyup',e=>{if(e.key==='PrintScreen'){try{navigator.clipboard.writeText('')}catch(x){}alert('Screenshot dinonaktifkan.')}})}async function SF(i,n){let u=typeof i==='string'?i:(i&&i.url);if(!u)throw new Error('safeFetch invalid');let ok=false;for(let a of cfg.safeFetchDefaults.allowedOrigins){if(u.startsWith(a)){ok=true;break}}if(!ok&&u.startsWith(location.origin))ok=true;if(!ok)throw new Error('safeFetch denied '+u);n=n||{};n.headers=n.headers||{};Object.assign(n.headers,cfg.safeFetchDefaults.addHeaders);return await fetch(u,n)}function INIT(o){try{cfg=Object.assign({},cfg,o||{});DE();RS();OBS();RIH();AF();BL();setTimeout(()=>{try{const s=Date.now();debugger;const d=Date.now()-s;if(d>100)l('Devtools detected')}catch(x){}},2000)}catch(x){console.error('security init fail',x)}}w.security={init:INIT,sanitizeString:S,sanitizeInputElement:SI,safeFetch:SF,config:()=>cfg};if(d.readyState==='loading')d.addEventListener('DOMContentLoaded',()=>INIT());else INIT()})(window,document);