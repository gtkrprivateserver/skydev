<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Giveaway - OneDev Entertainment</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="menu.css" />

  <style>
    /* Extra styling agar cocok dengan website */
    .giveaway-card {
      background:#111;
      padding:30px;
      border-radius:18px;
      box-shadow:0 0 20px rgba(255,255,255,0.07);
      max-width:700px;
      margin:auto;
      text-align:center;
      border:1px solid #333;
    }
    .join-btn {
      margin-top:20px;
      padding:14px 30px;
      background:#fff;
      color:#000;
      border-radius:10px;
      font-size:18px;
      cursor:pointer;
      font-weight:bold;
    }
    .admin-panel {
      margin-top:40px;
      padding:20px;
      background:#0d0d0d;
      border-radius:15px;
      border:1px solid #333;
      max-width:450px;
      margin-left:auto;
      margin-right:auto;
    }
    input.admin-input {
      width:100%;
      padding:10px;
      margin-top:10px;
      margin-bottom:20px;
      background:#111;
      border:1px solid #333;
      border-radius:10px;
      color:white;
    }
    .admin-btn {
      padding:12px 20px;
      background:#fff;
      color:#000;
      font-weight:bold;
      border-radius:10px;
      cursor:pointer;
      width:100%;
    }
  </style>
</head>
<body>

<!-- NAVBAR -->
<header class="nav">
  <div class="nav-inner">
    <div class="brand">
      <div class="logo">OD</div>
      <span class="brand-name">OneDev</span>
    </div>

    <nav class="menu" id="menu"></nav>

    <button id="burger" class="burger">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<div class="sidebar"><div class="sidebar-content"></div></div>
<div class="sidebar-overlay"></div>

<!-- MAIN GIVEAWAY -->
<main class="hero">
  <div class="container">

    <div class="giveaway-card">

      <h1 class="hi">üéâ Giveaway Besar <span class="name">OneDev</span></h1>
      <p class="lead">Ikuti event giveaway resmi OneDev Entertainment!</p>

      <h2 style="margin-top:25px;">‚è≥ Waktu Tersisa</h2>
      <h1 id="main-timer" style="font-size:50px; margin-top:10px;">00:00:00</h1>

      <button class="join-btn" id="join-btn">üéüÔ∏è Ikut Giveaway</button>
      <p id="join-status" style="margin-top:15px; font-size:16px;"></p>

    </div>

    <!-- ADMIN ONLY TIMER -->
    <div id="admin-panel" class="admin-panel" style="display:none;">
      <h2>‚öôÔ∏è Admin Panel</h2>
      <label>Set Durasi Event (Menit):</label>
      <input type="number" id="admin-duration" class="admin-input" placeholder="Misal: 60 untuk 1 jam">

      <button class="admin-btn" id="save-admin-timer">Simpan Timer</button>
      <p id="admin-msg" style="margin-top:10px;"></p>

      <h3 style="margin-top:30px;">‚è± Admin View Timer</h3>
      <h2 id="admin-timer" style="font-size:35px;">00:00:00</h2>
    </div>

  </div>
</main>

<footer class="footer">
  &copy; 2025 OneDev Entertainment. All rights reserved.
</footer>

<script src="menu.js"></script>

<script>
/* ================================
   CEK ADMIN MODE
================================ */
const isAdmin = window.location.search.includes("admin");
if (isAdmin) {
  document.getElementById("admin-panel").style.display = "block";
}

/* ================================
   LOAD / INIT END TIME
================================ */
let endTime = localStorage.getItem("giveawayEndTime");

if (!endTime) {
  endTime = Date.now() + (3600 * 1000); // default 1 jam
  localStorage.setItem("giveawayEndTime", endTime);
} else {
  endTime = parseInt(endTime);
}

/* ================================
   SISTEM PESERTA
================================ */
let participants = JSON.parse(localStorage.getItem("participants") || "[]");

function saveParticipants() {
  localStorage.setItem("participants", JSON.stringify(participants));
}

document.getElementById("join-btn").addEventListener("click", () => {
  let user = prompt("Masukkan nama kamu:");

  if (!user) return;

  if (participants.includes(user)) {
    document.getElementById("join-status").innerText = "‚ùó Kamu sudah ikut.";
    return;
  }

  participants.push(user);
  saveParticipants();

  document.getElementById("join-status").innerText = "‚úî Kamu berhasil ikut giveaway!";
});

/* ================================
   ADMIN SET TIME
================================ */
document.getElementById("save-admin-timer")?.addEventListener("click", () => {
  let minutes = parseInt(document.getElementById("admin-duration").value);

  if (isNaN(minutes) || minutes <= 0) {
    document.getElementById("admin-msg").innerText = "Durasi tidak valid!";
    return;
  }

  endTime = Date.now() + (minutes * 60 * 1000);
  localStorage.setItem("giveawayEndTime", endTime);

  document.getElementById("admin-msg").innerText = "‚úî Timer berhasil diupdate!";
});

/* ================================
   TIMER (USER + ADMIN)
================================ */
function updateTimers() {
  let now = Date.now();
  let diff = endTime - now;

  let h = Math.floor(diff / (1000*60*60));
  let m = Math.floor((diff % (1000*60*60)) / (1000*60));
  let s = Math.floor((diff % (1000*60)) / 1000);

  let formatted =
    (h<10?"0"+h:h) + ":" +
    (m<10?"0"+m:m) + ":" +
    (s<10?"0"+s:s);

  if (diff > 0) {
    document.getElementById("main-timer").innerText = formatted;
    if (isAdmin) document.getElementById("admin-timer").innerText = formatted;
  } 
  else {
    document.getElementById("main-timer").innerText = "00:00:00";
    if (isAdmin) document.getElementById("admin-timer").innerText = "00:00:00";

    clearInterval(timerInterval);
  }
}

let timerInterval = setInterval(updateTimers, 1000);
updateTimers();
</script>

</body>
</html>